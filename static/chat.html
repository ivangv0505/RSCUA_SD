<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Chat P2P - RSCUA_SD</title>
    <!-- Enlaces a estilos reutilizados -->
    <link rel="stylesheet" href="css/HeaderStyle.css">
    <link rel="stylesheet" href="css/FeedStyle.css">
    <link rel="stylesheet" href="css/MensajeriaStyle.css">
    <link rel="stylesheet" href="css/PerfilStyle.css">
    <link rel="stylesheet" href="css/InterfaceChatstyle.css">
    <style>
        /* Ajustes de margen para la barra superior */
        body { padding-top: 80px; }
        .barra { position: fixed; top: 0; left: 0; width: 100%; z-index: 1000; background: white; border-bottom: 1px solid #ddd; }
        .search-results { position: absolute; top: 45px; left:0; width: 100%; background: white; border: 1px solid #ccc; z-index: 2000; max-height: 300px; overflow-y: auto; display:none; border-radius: 0 0 5px 5px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        /* Botón P2P */
        #btnP2P {
            margin-left: 10px;
            padding: 5px 10px;
            font-size: 0.8em;
            background-color: #17a2b8;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- Barra de navegación similar al resto del sitio -->
    <div class="barra">
        <button onclick="window.location.href='perfil.html'" title="Perfil"><img src="imagenes/perfil.jpg" id="headerAvatar" alt="Perfil"></button>
        <button onclick="window.location.href='feed.html'" title="Inicio"><img src="imagenes/inicio.jpg" alt="Inicio"></button>
        <button class="btn-notificacion" onclick="window.location.href='notificaciones.html'" title="Notificaciones"><img src="imagenes/notificaciones.png" alt="Notificaciones"><span id="badgeNotis" class="badge">0</span></button>
        <button onclick="window.location.href='comunidades.html'" title="Comunidades"><img src="imagenes/comunidad.png" alt="Comunidades"></button>
        <div class="busqueda" style="position:relative;">
            <input type="text" placeholder="Buscar en RSCUA..." id="inputBusquedaGlobal">
            <button><img src="imagenes/busqueda.jpg" alt="Buscar"></button>
            <div id="searchResults" class="search-results"></div>
        </div>
        <button onclick="window.location.href='eventos.html'" title="Eventos"><img src="imagenes/IconoEvento.png" alt="Eventos"></button>
        <button onclick="window.location.href='mensajeria.html'" title="Mensajes"><img src="imagenes/chats.png" alt="Mensajes"></button>
        <button onclick="window.location.href='configuracion.html'" title="Configuración"><img src="imagenes/configuracion.jpg" alt="Configuración"></button>
        <button onclick="logout()" title="Cerrar Sesión"><img src="imagenes/salida.jpg" alt="Salir"></button>
    </div>
    <!-- Contenedor de chat -->
    <div class="contenedor-mensajeria" style="margin-top: 20px;">
        <div class="panel-izquierdo">
            <h2>Conversaciones</h2>
            <ul class="lista-contactos" id="listaContactos"><p>Cargando...</p></ul>
        </div>
        <div class="panel-derecho">
            <div class="encabezado-chat">
                <h3 id="nombreContacto">Selecciona un chat</h3>
                <!-- Botón para iniciar la conexión P2P -->
                <button id="btnP2P" onclick="iniciarConexionP2P()" title="Iniciar conexión P2P">P2P</button>
            </div>
            <div class="mensajes" id="mensajesChat"><p class="sistema">Selecciona un contacto.</p></div>
            <div class="input-mensaje">
                <input type="text" placeholder="Escribe..." id="inputTexto">
                <button onclick="enviarMensaje()">Enviar</button>
            </div>
        </div>
    </div>
    <!-- Scripts -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="js/chat.js"></script>
    <script src="js/busqueda.js"></script>
    <script>
        function logout() { localStorage.clear(); window.location.href="login.html"; }
    </script>
</body>
</html>